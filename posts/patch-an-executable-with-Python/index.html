<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Patch an executable with Python" /><meta property="og:locale" content="en" /><meta name="description" content="Hopper is a very useful disassembler for Mac/Linux and I use it all the time when I need to reverse a binary. The problem is that it costs a whole 99€ to get a license and be able to export a patched binary. In this post, I will show how to apply patches to a binary thanks to Python. Note that this method can also be adapted to any programming language, such as C or others. It can also be used to automate patches if needed." /><meta property="og:description" content="Hopper is a very useful disassembler for Mac/Linux and I use it all the time when I need to reverse a binary. The problem is that it costs a whole 99€ to get a license and be able to export a patched binary. In this post, I will show how to apply patches to a binary thanks to Python. Note that this method can also be adapted to any programming language, such as C or others. It can also be used to automate patches if needed." /><link rel="canonical" href="https://machxnu.github.io/posts/patch-an-executable-with-Python/" /><meta property="og:url" content="https://machxnu.github.io/posts/patch-an-executable-with-Python/" /><meta property="og:site_name" content="MachXNU" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-24T15:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Patch an executable with Python" /><meta name="twitter:site" content="@machxnu" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-24T15:00:00+02:00","datePublished":"2022-04-24T15:00:00+02:00","description":"Hopper is a very useful disassembler for Mac/Linux and I use it all the time when I need to reverse a binary. The problem is that it costs a whole 99€ to get a license and be able to export a patched binary. In this post, I will show how to apply patches to a binary thanks to Python. Note that this method can also be adapted to any programming language, such as C or others. It can also be used to automate patches if needed.","headline":"Patch an executable with Python","mainEntityOfPage":{"@type":"WebPage","@id":"https://machxnu.github.io/posts/patch-an-executable-with-Python/"},"url":"https://machxnu.github.io/posts/patch-an-executable-with-Python/"}</script><title>Patch an executable with Python | MachXNU</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="MachXNU"><meta name="application-name" content="MachXNU"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /img/eve.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">MachXNU</a></div><div class="site-subtitle font-italic">Articles and tutorials about iOS, macOS and Linux</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/MachXNU" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/machxnu" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://t.me/MachXNU" aria-label="telegram" > <i class="fab fa-telegram"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Patch an executable with Python</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Patch an executable with Python</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/machxnu">MachXNU</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1650805200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-24 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="837 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://www.hopperapp.com">Hopper</a> is a very useful disassembler for Mac/Linux and I use it all the time when I need to reverse a binary.<br /> The problem is that it costs a whole 99€ to get a license and be able to export a patched binary.<br /> In this post, I will show how to apply patches to a binary thanks to Python.<br /> Note that this method can also be adapted to any programming language, such as C or others. It can also be used to automate patches if needed.</p><h2 id="find-something-to-patch"><span class="mr-2">Find something to patch</span><a href="#find-something-to-patch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s use a simple example.<br /> Consider the following code :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">age</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"How old are you ? "</span><span class="p">);</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">age</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">age</span><span class="o">&lt;</span><span class="mi">18</span><span class="p">){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"You are a child</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"You are an adult</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Assume you are given only the compiled binary, but you are only 10 y.o.<br /> We will patch the binary so that it displays <code class="language-plaintext highlighter-rouge">You are an adult</code> even if you are too young.</p><h2 id="find-what-patches-to-apply-with-hopper"><span class="mr-2">Find what patches to apply with Hopper</span><a href="#find-what-patches-to-apply-with-hopper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Load the compiled binary in Hopper and navigate to its main function.<br /> It should be easy to see that there is an <code class="language-plaintext highlighter-rouge">if</code> instruction which redirects execution if you are an adult. <img data-src="/img/2022-04-24-PATCH/main.png" alt="Desktop View" class="shadow" data-proofer-ignore> <em>The strings are displayed, but too far on the right to be visible here</em></p><p>We must patch the jump to redirect execution to the second bloc regardless of the result of the test before.<br /> The solution is to replace the conditional jump <code class="language-plaintext highlighter-rouge">b.le</code> by an unconditionnal jump <code class="language-plaintext highlighter-rouge">b</code>.<br /> To do this, go to <code class="language-plaintext highlighter-rouge">Modify &gt; Assemble instruction...</code> or use the keyboard shortcut <code class="language-plaintext highlighter-rouge">Option + A</code> and type the new instruction (adapt it if necessary with the correct name of the bloc) : <code class="language-plaintext highlighter-rouge">b loc_100003f18</code><br /> <img data-src="/img/2022-04-24-PATCH/assemble.png" alt="Desktop View" class="shadow" width="500" data-proofer-ignore><br /> As you can see after patching, the “child” region is never executed, and the execution flow will directly jump to the “adult” bloc.<br /> <img data-src="/img/2022-04-24-PATCH/jump.png" alt="Desktop View" class="shadow" width="500" data-proofer-ignore><br /> Now, the first thing you need to note down is the <strong>offset</strong> from the beginning of your binary.<br /> It is the offset from the binary’s base <code class="language-plaintext highlighter-rouge">0x100000000</code> to your instruction.<br /> To double check what the base is, navigate to the Mach-O header :<br /> <img data-src="/img/2022-04-24-PATCH/header.png" alt="Desktop View" class="shadow" width="500" data-proofer-ignore> <em>This is the Mach-O header</em> For us, the offset will be <code class="language-plaintext highlighter-rouge">0x100003f04 - 0x100000000 = 0x3f04</code><br /> Next, we need to find what the new instruction is like in binary code.<br /> Select the instruction in the ASM view and switch to hexadecimal view.<br /> <img data-src="/img/2022-04-24-PATCH/gotohex.png" alt="Desktop View" class="shadow" data-proofer-ignore> <em>Make sure you have selected the patched instruction</em> You will see values in red, these are the new hex values for the patched instruction.<br /> <img data-src="/img/2022-04-24-PATCH/hex.png" alt="Desktop View" class="shadow" data-proofer-ignore> <em>The patched instruction has its hex representation in red</em> Note them down as well, as we will need them later on.<br /> The Hopper part is done, so make sure you got the <strong>offset</strong> and the <strong>hex</strong> representation of the instruction.</p><h2 id="write-a-python-script-and-apply-patches"><span class="mr-2">Write a Python script and apply patches</span><a href="#write-a-python-script-and-apply-patches" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I have provided the script, just after this text.<br /> As you can see, we are first loading the original binary in binary mode. This gives us a <code class="language-plaintext highlighter-rouge">&lt;bytes&gt;</code> object. Since <code class="language-plaintext highlighter-rouge">&lt;bytes&gt;</code> objects are immutable, we need to convert it to a (mutable) array.<br /> Once this is done, we simply replace the value at the <strong>offset</strong> by the new <strong>hex</strong> representation.<br /> That is why we needed both values.<br /> Here is the script :</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="nn">sys</span>
 
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Please input path to the binary you want to patch.'</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">instruction</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"[i] Replacing instruction at offset"</span><span class="p">,</span> <span class="nb">hex</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>
    <span class="n">content</span><span class="p">[</span><span class="n">offset</span> <span class="p">:</span> <span class="n">offset</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">instruction</span><span class="p">)]</span> <span class="o">=</span> <span class="n">instruction</span>

<span class="k">def</span> <span class="nf">bytes_to_array</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s">'</span><span class="se">\x00</span><span class="s">'</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">L</span>

<span class="n">orig_file</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">patched_file</span> <span class="o">=</span> <span class="n">orig_file</span> <span class="o">+</span> <span class="s">'_patched'</span>
<span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">orig_file</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">bytes_to_array</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">replace</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="mh">0x3f04</span><span class="p">,</span> <span class="sa">b</span><span class="s">'</span><span class="se">\x05\x00\x00\x14</span><span class="s">'</span><span class="p">)</span>  <span class="c1"># replace if necessary
</span><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">patched_file</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">content</span><span class="p">))</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Patched file created"</span><span class="p">)</span>
</pre></table></code></div></div><p>Then, patch the executable :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./patcher.py &lt;path-to-executable&gt;
</pre></table></code></div></div><p>The produced binary is called <code class="language-plaintext highlighter-rouge">&lt;original_name_patched&gt;</code> and can be found at the same path than the original file.<br /> What you have to do next is configure your system to execute this patched binary. Many systems include protections against this type of attack, and iOS or macOS are no exceptions to this.<br /> See <a href="https://machxnu.github.io/posts/15-00-MAC-CODESIGN/">my other blog article about running patched executables on macOS</a> to effectively run this patched executable on your machine ! <br /> However, as a spoiler, I can already show you that our patch worked : <img data-src="/img/2022-04-24-PATCH/patched.png" alt="Desktop View" class="shadow" data-proofer-ignore> <em>Wow, society is moving at a fast pace !</em></p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>To summarize, you can use Hopper to see what/where patches should be applied and see what the new instructions will look like after the patch.<br /> Then, a simple script (which can of course be adapted to any language) applies the patches and produces the patched executable.<br /> Finally, you have to configure your system to run this patched executable, but this is too OS-specific to be discussed here.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Patch an executable with Python - MachXNU&amp;url=https://machxnu.github.io/posts/patch-an-executable-with-Python/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Patch an executable with Python - MachXNU&amp;u=https://machxnu.github.io/posts/patch-an-executable-with-Python/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://machxnu.github.io/posts/patch-an-executable-with-Python/&amp;text=Patch an executable with Python - MachXNU" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Cross-compiling-radare2-for-armhf-and-Buildroot/">Cross-compiling radare2 for armhf and Buildroot</a><li><a href="/posts/Enabling-framebuffer-on-qemu_arm_versatile-and-buildroot/">Enabling framebuffer on qemu_arm_versatile and Buildroot</a><li><a href="/posts/macOS-theming/">Fulling theming macOS Big Sur</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Debugger-Android-no-root/"><div class="card-body"> <em class="timeago small" data-ts="1744372800" > 2025-04-11 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Run Android apps in a debugger without root</h3><div class="text-muted small"><p> Introduction In this article, I will explain how to run a compiled third-party Android app in a debugger like lldb on a non-rooted device. Prerequisites Install Android Studio and download the S...</p></div></div></a></div><div class="card"> <a href="/posts/Frida-gadget-on-iOS-18/"><div class="card-body"> <em class="timeago small" data-ts="1743350400" > 2025-03-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Frida Gadget/Objection on iOS 18</h3><div class="text-muted small"><p> Introduction Running Frida gadget on (jailed) iOS 18 can be suprisingly more difficult that expected. In this article, I am providing a full method to get Frida Gadget running on such a device. P...</p></div></div></a></div><div class="card"> <a href="/posts/Cross-compiling-radare2-for-armhf-and-Buildroot/"><div class="card-body"> <em class="timeago small" data-ts="1739710800" > 2025-02-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cross-compiling radare2 for armhf and Buildroot</h3><div class="text-muted small"><p> Introduction In this article, we will learn how to compile radare2 for armhf using Buildroot’s toolchain (note that this can be adapted to any other cross-toolchain you have, either you got it from...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/run-a-patched-executable-on-macOS/" class="btn btn-outline-primary" prompt="Older"><p>Run a patched executable on macOS</p></a> <a href="/posts/verbose-restore-64-bits/" class="btn btn-outline-primary" prompt="Newer"><p>Verbose restore a 64 bits iPhone with checkm8</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/machxnu">MachXNU</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
